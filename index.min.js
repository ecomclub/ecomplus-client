"use strict";var isNodeJs=false;if(typeof module!=="undefined"&&module.exports){isNodeJs=true}var EcomIo=function(){let storeId,https,loggerif(isNodeJs){https=require("https")}let runMethod=function(g,e,d,f,a){let pathif(!d){d="api.e-com.plus";path="/v1"}else{if(d!=="api.e-com.plus"){path="/api/v1"}}if(!f){f="GET"}if(isNodeJs===true){const b={hostname:d,path:path+e,method:f,headers:{"Content-Type":"application/json","X-Store-ID":storeId}};const c=https.request(b,function(h){if(h.statusCode!==200){let err=new Error("Request failed trying to get store info\nStatus code: "+h.statusCode)logger.error(err);h.resume();return}let rawData=""h.setEncoding("utf8");h.on("data",function(j){rawData+=j});h.on("end",function(){try{let a=JSON.parse(rawData)if(typeof g==="function"){g(a)}else{return a}}catch(j){logger.error(j)}});c.on("error",function(j){logger.error("problem with request:"+j.message)});c.end()})}else{let ajax=new XMLHttpRequest()let url="https://"+d+path+eajax.open(f,url,true);ajax.send();ajax.onreadystatechange=function(){if(ajax.readyState===4&&ajax.status===200){let a=JSON.parse(ajax.responseText)if(typeof g==="function"){g(a)}else{return a}}}}}return{init:function(b,a){storeId=b;if(typeof a==="object"&&a.hasOwnProperty("log")&&a.hasOwnProperty("error")){logger=a}else{logger=console}},storeId:storeId,getProductBySku:function(b,a){let response=runMethod(a,"/products.json?sku="+b).done(function(){for(let i=0;i<response.result;i++){EcomIo.getProduct(response.result[i]._id,a)}})},getProduct:function(b,a){runMethod(a,"/products/"+b+".json")},getOrder:function(b,a){runMethod(a,"/orders/"+b+".json")},getBrands:function(c,a){var b;if(!a){b="/brands.json"}else{b="/brands.json?"+a}runMethod(c,b)},getCategories:function(c,a){var b;if(!a){b="/categories.json"}else{b="/categories.json?"+a}runMethod(c,b)},searchProduts:function(c,b,d,h){var e="apx-search.e-com.plus";var g="POST";var f="/items.json";if(typeof b==="number"){switch(b){case 1:b={sales:"desc"};break;case 2:b={price:"asc"};break;case 3:b={price:"desc"};break;default:b={views:"desc"}}}else{if(typeof b!=="object"){b={views:"desc"}}}var a={query:{multi_match:{query:c,fields:["name","keywords"]},sort:[{available:true},"_score",{ad_relevance:"desc"},b],bool:{filter:[{term:{visible:true}}]}}};if(typeof d==="object"){for(let key in d){if(d.hasOwnProperty(key)){let propertyObject=d[key]for(let key2 in propertyObject){if(propertyObject.hasOwnProperty(key2)&&Array.isArray(propertyObject[key2])){for(let i=0;i<propertyObject[key2].length;i++){let bodytoFilter={term:{}}bodytoFilter.term[key]={};bodytoFilter.term[key][key2]=propertyObject[key2][i];a.bool.filter.push(bodytoFilter)}}}}}}runMethod(h,f,e,g,a)}}};EcomIo=EcomIo();if(isNodeJs){module.exports=EcomIo};