(function(){var g=false;if(typeof module!=="undefined"&&module.exports){g=true}var a="api.e-com.plus";var d="ioapi.ecvol.com";var f="e-com.plus";var b="io.ecvol.com";var i="apx-search.e-com.plus";var e="apx-graphs.e-com.plus";var c="apx-mods.e-com.plus";var h=(function(){var u,p,v,t;if(g&&typeof XMLHttpRequest==="undefined"&&typeof XDomainRequest==="undefined"){v=require("https")}var m=function(x){return"E-Com Plus SDK "+x+":"};var o=function(A,y,z){if(typeof A==="function"){var x=new Error(y);if(z===undefined){A(x,null)}else{A(x,z)}}t.log(m("WARNING")+"\n"+y)};var l=function(D,C,y,x,B){var A;if(typeof D!=="function"){A="You need to specify a callback function to receive the request response";o(null,A);return}var z;if(!y){y=a;z="/v1"}else{switch(y){case d:z="/"+u+"/v1";break;case a:z="/v1";break;default:z="/api/v1"}}z+=C;if(typeof B!=="number"){B=0}k(B,y,z,x,D,C)};var k=function(F,I,K,C,G,H){var x;if(!C){x="GET"}else{x="POST"}var z={};switch(I){case a:case i:case e:z["X-Store-ID"]=u;z["Content-Type"]="application/json";break}var B=function(){if(H){switch(I){case d:I=a;l(G,H,I,C,F);return;case b:I=f;l(G,H,I,C,F);return;case a:I=d;l(G,H,I,C,F);return;case f:I=b;l(G,H,I,C,F);return}}setTimeout(function(){k(F,I,K,C,G)},500)};if(v){var J={hostname:I,path:K,method:x,headers:z};var D=v.request(J,function(L){if(L.statusCode===503&&F<3){B();L.resume();return}var M="";L.setEncoding("utf8");L.on("data",function(N){M+=N});L.on("end",function(){n(L.statusCode,M,G)})});D.on("error",function(L){t.error(L);G(L,null)});if(C){D.write(JSON.stringify(C))}D.end()}else{var E;if(window.XDomainRequest){E=new XDomainRequest();E.ontimeout=E.onerror=function(){B()};E.onload=function(){n(200,this.responseText,G)}}else{E=new XMLHttpRequest();E.onreadystatechange=function(){if(this.readyState===4){if(this.status===503&&F<3){B()}else{n(this.status,this.responseText,G)}}}}var y="https://"+I+K;E.open(x,y,true);for(var A in z){if(z.hasOwnProperty(A)){E.setRequestHeader(A,z[A])}}if(C){E.send(JSON.stringify(C))}else{E.send()}}F++};var n=function(y,A,C){var x;try{x=JSON.parse(A)}catch(z){t.error(z);C(z,null);return}if(y===200){C(null,x)}else{var B;if(x.hasOwnProperty("message")){B=x.message}else{B="Unknown error, see response objet to more info"}o(C,B,x)}};var s=function(z,y){var x;if(typeof y==="string"){if(y.match(/^[a-f0-9]{24}$/)){return true}else{x="ID must be a valid 24 hexadecimal digits string, lowercase only"}}else{x="ID is required and must be a string"}o(z,x);return false};var w=function(A,y,z){if(s(A,z)){var x=d;l(A,"/"+y+"/"+z+".json",x)}};var r=function(D,z,C,x,B,y){if(typeof z==="string"){l(function(G,E){if(!G){var F=E.result;if(Array.isArray(F)&&typeof F[0]==="object"&&F[0]!==null){y(D,F[0]._id)}else{var H="Any "+x+" found with this "+C;o(D,H,E)}}else{D(G,E)}},B)}else{var A="The"+C+" is required and must be a string";o(D,A)}};var q=function(E,x,A,z,B,C,y){var D=j(A,z,B,C,y);var G="/"+x+".json";var F;if(D===""){F=d}else{G+=D}l(E,G,F)};var j=function(C,B,E,F,z){var A={};var G="";if(typeof z!=="string"){if(typeof C==="number"&&C>0){A.offset=C}if(typeof B==="number"&&B>0){A.limit=B}if(typeof E==="number"){switch(E){case 1:A.sort="name";break;case 2:A.sort="-name";break}}if(Array.isArray(F)){var x="";for(var D=0;D<F.length;D++){if(typeof F[D]==="string"){if(x!==""){x+="%2C"}x+=F[D]}}if(x!==""){A.fields=x}}for(var y in A){if(A.hasOwnProperty(y)){if(G!==""){G+="&"}G+=y+"="+A[y]}}}else{G=z}if(G!==""){G="?"+G}return G};return{init:function(D,A,z,x){if(typeof x==="object"&&x.hasOwnProperty("log")&&x.hasOwnProperty("error")){t=x}else{t=console}if(A&&z){u=A;p=z;if(typeof D==="function"){var B={id:null,channel_id:null,store_id:u,store_object_id:p,default_lang:null};D(null,B)}}else{if(typeof location==="object"){var F=b;var E="/domains/"+window.location.hostname+".json";var C=function(H,G){if(!H){u=G.store_id;p=G.store_object_id}if(typeof D==="function"){D(H,G)}};l(C,E,F)}else{var y="It is necessary to specify the store ID as an init argument";o(D,y)}}},storeId:function(){return u},storeObjectId:function(){return p},getStore:function(y,x){if(x===undefined&&p){x=p}w(y,"stores",x)},getProduct:function(y,x){w(y,"products",x)},getProductBySku:function(z,y){var x="/products.json?sku="+y;r(z,y,"SKU","product",x,h.getProduct)},getOrder:function(y,x){w(y,"orders",x)},getCart:function(y,x){w(y,"carts",x)},getCustomer:function(y,x){w(y,"customers",x)},getApplication:function(y,x){w(y,"applications",x)},getBrand:function(y,x){w(y,"brands",x)},findBrandBySlug:function(z,x){var y="/brands.json?limit=1&slug="+x;l(z,y)},listBrands:function(C,B,y,z,x,A){q(C,"brands",B,y,z,x,A)},getCategory:function(y,x){w(y,"categories",x)},findCategoryBySlug:function(z,x){var y="/categories.json?limit=1&slug="+x;l(z,y)},listCategories:function(C,B,y,z,x,A){q(C,"categories",B,y,z,x,A)},getCollection:function(y,x){w(y,"collections",x)},findCollectionBySlug:function(z,x){var y="/collections.json?limit=1&slug="+x;l(z,y)},listCollections:function(C,B,y,z,x,A){q(C,"collections",B,y,z,x,A)},getById:w,searchProducts:function(J,A,H,N,C,z,y,M,E,B,x){var L=i;var K="/items.json";var F;if(typeof x==="object"&&x!==null){F=x}else{if(typeof C==="number"){switch(C){case 1:C={sales:{order:"desc"}};break;case 2:C={price:{order:"asc"}};break;case 3:C={price:{order:"desc"}};break;default:C={views:{order:"desc"}}}}else{if(!C){C={views:{order:"desc"}}}}F={query:{bool:{filter:[{term:{visible:true}}]}},sort:[{available:{order:"desc"}},"_score",{ad_relevance:{order:"desc"}},C],aggs:{brands:{terms:{field:"brands.name"}},categories:{terms:{field:"categories.name"}},specs:{nested:{path:"specs"},aggs:{grid:{terms:{field:"specs.grid",size:12},aggs:{text:{terms:{field:"specs.text"}}}}}},min_price:{min:{field:"price"}},max_price:{max:{field:"price"}},avg_price:{avg:{field:"price"}}}};if(typeof A==="string"){F.query.bool.must={multi_match:{query:A,fields:["name","keywords"]}}}if(typeof H==="number"&&H>0){F.from=H}if(typeof N==="number"&&N>0){F.size=N}else{F.size=24}if(typeof z==="object"&&z!==null&&Object.keys(z).length>0){var G={nested:{path:"specs",query:{bool:{filter:[]}}}};for(var I in z){if(Array.isArray(z[I])&&z[I].length>0){G.nested.query.bool.filter.push({term:{"specs.grid":I}},{terms:{"specs.text":z[I]}});F.query.bool.filter.push(G)}}}if(Array.isArray(y)&&y.length>0){F.query.bool.filter.push({terms:{_id:y}})}if(Array.isArray(M)&&M.length>0){F.query.bool.filter.push({terms:{"brands.name":M}})}if(Array.isArray(E)&&E.length>0){F.query.bool.filter.push({terms:{"categories.name":E}})}if(typeof B==="object"&&B!==null&&Object.keys(B).length>0){var D={range:{price:{}}};if(typeof B.min==="number"&&!isNaN(B.min)){D.range.price.gte=B.min}if(typeof B.max==="number"&&!isNaN(B.max)){D.range.price.lte=B.max}F.query.bool.filter.push(D)}}l(J,K,L,F)},mapBySlug:function(B,y){var z="iostorefront.ecvol.com";var A="/"+u+"@"+y.replace("/","$")+".json";var x=function(D,C){if(!D){var F=C.GET;if(F){F=F.split("@");C={resource:F[0],_id:F[1]};B(null,C)}else{C={status:404,error_code:-44,message:"Page not found, invalid slug or store ID"};var E=C.message;o(B,E,C)}}else{B(D,C)}};l(x,A,z)},mapByWindowUri:function(z){if(typeof location==="object"){var x=window.location.pathname.slice(1);h.mapBySlug(z,x)}else{var y="This method is available client side only (JS on browser)";o(z,y)}},listRecommendedProducts:function(A,z){if(s(z)){var x=e;var y="/products/"+z+"/recommended.json";l(A,y,x)}},listRelatedProducts:function(A,z){if(s(z)){var x=e;var y="/products/"+z+"/related.json";l(A,y,x)}},calculateShipping:function(z,x){var y="/calculate_shipping.json";l(z,y,c,x)},listPayments:function(z,x){var y="/list_payments.json";l(z,y,c,x)},createTransaction:function(z,x){var y="/create_transaction.json";l(z,y,c,x)},http:l}}());if(g){module.exports=h}else{window.EcomIo=h}}());