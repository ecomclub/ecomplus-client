(function(){var a=false;if(typeof module!=="undefined"&&module.exports){a=true}var b=(function(){var n,i,o,m;if(a&&typeof XMLHttpRequest==="undefined"&&typeof XDomainRequest==="undefined"){o=require("https")}var f=function(q){return"E-Com Plus SDK "+q+":"};var h=function(t,r,s){if(typeof t==="function"){var q=new Error(r);if(s===undefined){t(q,null)}else{t(q,s)}}m.log(f("WARNING")+"\n"+r)};var e=function(w,v,r,q,u){var t;if(typeof w!=="function"){t="You need to specify a callback function to receive the request response";h(null,t);return}var s;if(!r){r="api.e-com.plus";s="/v1"}else{switch(r){case"ioapi.ecvol.com":s="/"+n+"/v1";break;case"api.e-com.plus":s="/v1";break;default:s="/api/v1"}}s+=v;if(typeof u!=="number"){u=0}d(u,r,s,q,w,v)};var d=function(y,B,D,v,z,A){var q;if(!v){q="GET"}else{q="POST"}var s={};switch(B){case"api.e-com.plus":case"apx-search.e-com.plus":case"apx-graphs.e-com.plus":s["X-Store-ID"]=n;s["Content-Type"]="application/json";break}var u=function(){if(A){switch(B){case"ioapi.ecvol.com":B="api.e-com.plus";e(z,A,B,v,y);return;case"io.ecvol.com":B="e-com.plus";e(z,A,B,v,y);return;case"api.e-com.plus":B="ioapi.ecvol.com";e(z,A,B,v,y);return;case"e-com.plus":B="io.ecvol.com";e(z,A,B,v,y);return}}setTimeout(function(){d(y,B,D,v,z)},500)};if(o){var C={hostname:B,path:D,method:q,headers:s};var w=o.request(C,function(E){if(E.statusCode===503&&y<3){u();E.resume();return}var F="";E.setEncoding("utf8");E.on("data",function(G){F+=G});E.on("end",function(){g(E.statusCode,F,z)})});w.on("error",function(E){m.error(E);z(E,null)});if(v){w.write(JSON.stringify(v))}w.end()}else{var x;if(window.XDomainRequest){x=new XDomainRequest();x.ontimeout=x.onerror=function(){u()};x.onload=function(){g(200,this.responseText,z)}}else{x=new XMLHttpRequest();x.onreadystatechange=function(){if(this.readyState===4){if(this.status===503&&y<3){u()}else{g(this.status,this.responseText,z)}}}}var r="https://"+B+D;x.open(q,r,true);for(var t in s){if(s.hasOwnProperty(t)){x.setRequestHeader(t,s[t])}}if(v){x.send(JSON.stringify(v))}else{x.send()}}y++};var g=function(r,t,v){var q;try{q=JSON.parse(t)}catch(s){m.error(s);v(s,null);return}if(r===200){v(null,q)}else{var u;if(q.hasOwnProperty("message")){u=q.message}else{u="Unknown error, see response objet to more info"}h(v,u,q)}};var l=function(s,r){var q;if(typeof r==="string"){if(r.match(/^[a-f0-9]{24}$/)){return true}else{q="ID must be a valid 24 hexadecimal digits string, lowercase only"}}else{q="ID is required and must be a string"}h(s,q);return false};var p=function(t,r,s){if(l(t,s)){var q="ioapi.ecvol.com";e(t,"/"+r+"/"+s+".json",q)}};var k=function(w,s,v,q,u,r){if(typeof s==="string"){e(function(z,x){if(!z){var y=x.result;if(Array.isArray(y)&&typeof y[0]==="object"&&y[0]!==null){r(w,y[0]._id)}else{var A="Any "+q+" found with this "+v;h(w,A,x)}}else{w(z,x)}},u)}else{var t="The"+v+" is required and must be a string";h(w,t)}};var j=function(x,q,t,s,u,v,r){var w=c(t,s,u,v,r);var z="/"+q+".json";var y;if(w===""){y="ioapi.ecvol.com"}else{z+=w}e(x,z,y)};var c=function(v,u,x,y,s){var t={};var z="";if(typeof s!=="string"){if(typeof v==="number"&&v>0){t.offset=v}if(typeof u==="number"&&u>0){t.limit=u}if(typeof x==="number"){switch(x){case 1:t.sort="name";break;case 2:t.sort="-name";break}}if(Array.isArray(y)){var q="";for(var w=0;w<y.length;w++){if(typeof y[w]==="string"){if(q!==""){q+="%2C"}q+=y[w]}}if(q!==""){t.fields=q}}for(var r in t){if(t.hasOwnProperty(r)){if(z!==""){z+="&"}z+=r+"="+t[r]}}}else{z=s}if(z!==""){z="?"+z}return z};return{init:function(x,u,r,s){if(typeof s==="object"&&s.hasOwnProperty("log")&&s.hasOwnProperty("error")){m=s}else{m=console}if(u&&r){n=u;i=r;if(typeof x==="function"){let body={id:null,channel_id:null,store_id:n,store_object_id:i,default_lang:null}x(null,body)}}else{if(typeof location==="object"){var t="io.ecvol.com";var w="/domains/"+window.location.hostname+".json";var q=function(z,y){if(!z){n=y.store_id;i=y.store_object_id}if(typeof x==="function"){x(z,y)}};e(q,w,t)}else{var v="It is necessary to specify the store ID as an init argument";h(x,v)}}},storeId:function(){return n},storeObjectId:function(){return i},getStore:function(r,q){if(q===undefined&&i){q=i}p(r,"stores",q)},getProduct:function(r,q){p(r,"products",q)},getProductBySku:function(s,r){var q="/products.json?sku="+r;k(s,r,"SKU","product",q,b.getProduct)},getOrder:function(r,q){p(r,"orders",q)},getCart:function(r,q){p(r,"carts",q)},getCustomer:function(r,q){p(r,"customers",q)},getApplication:function(r,q){p(r,"applications",q)},getBrand:function(r,q){p(r,"brands",q)},findBrandBySlug:function(s,q){var r="/brands.json?limit=1&slug="+q;e(s,r)},listBrands:function(v,u,r,s,q,t){j(v,"brands",u,r,s,q,t)},getCategory:function(r,q){p(r,"categories",q)},findCategoryBySlug:function(s,q){var r="/categories.json?limit=1&slug="+q;e(s,r)},listCategories:function(v,u,r,s,q,t){j(v,"categories",u,r,s,q,t)},getCollection:function(r,q){p(r,"collections",q)},findCollectionBySlug:function(s,q){var r="/collections.json?limit=1&slug="+q;e(s,r)},listCollections:function(v,u,r,s,q,t){j(v,"collections",u,r,s,q,t)},getById:p,searchProducts:function(C,t,A,G,v,s,r,F,x,u,q){var E="apx-search.e-com.plus";var D="/items.json";var y;if(typeof q==="object"&&q!==null){y=q}else{if(typeof v==="number"){switch(v){case 1:v={sales:{order:"desc"}};break;case 2:v={price:{order:"asc"}};break;case 3:v={price:{order:"desc"}};break;default:v={views:{order:"desc"}}}}else{if(!v){v={views:{order:"desc"}}}}y={query:{bool:{filter:[{term:{visible:true}}]}},sort:[{available:{order:"desc"}},"_score",{ad_relevance:{order:"desc"}},v],aggs:{brands:{terms:{field:"brands.name"}},categories:{terms:{field:"categories.name"}},specs:{nested:{path:"specs"},aggs:{grid:{terms:{field:"specs.grid",size:12},aggs:{text:{terms:{field:"specs.text"}}}}}},min_price:{min:{field:"price"}},max_price:{max:{field:"price"}},avg_price:{avg:{field:"price"}}}};if(typeof t==="string"){y.query.bool.must={multi_match:{query:t,fields:["name","keywords"]}}}if(typeof A==="number"&&A>0){y.from=A}if(typeof G==="number"&&G>0){y.size=G}else{y.size=24}if(typeof s==="object"&&s!==null&&Object.keys(s).length>0){var z={nested:{path:"specs",query:{bool:{filter:[]}}}};for(var B in s){if(Array.isArray(s[B])&&s[B].length>0){z.nested.query.bool.filter.push({term:{"specs.grid":B}},{terms:{"specs.text":s[B]}});y.query.bool.filter.push(z)}}}if(Array.isArray(r)&&r.length>0){y.query.bool.filter.push({terms:{_id:r}})}if(Array.isArray(F)&&F.length>0){y.query.bool.filter.push({terms:{"brands.name":F}})}if(Array.isArray(x)&&x.length>0){y.query.bool.filter.push({terms:{"categories.name":x}})}if(typeof u==="object"&&u!==null&&Object.keys(u).length>0){var w={range:{price:{}}};if(typeof u.min==="number"&&!isNaN(u.min)){w.range.price.gte=u.min}if(typeof u.max==="number"&&!isNaN(u.max)){w.range.price.lte=u.max}y.query.bool.filter.push(w)}}e(C,D,E,y)},mapBySlug:function(u,r){var s="iostorefront.ecvol.com";var t="/"+n+"+"+r.replace(/[/.]/g,"+")+".json";var q=function(w,v){if(!w){var y=v.GET;if(y){y=y.split("+");v={resource:y[0],_id:y[1]};u(null,v)}else{v={status:404,error_code:-44,message:"Page not found, invalid slug or store ID"};var x=v.message;h(u,x,v)}}else{u(w,v)}};e(q,t,s)},mapByWindowUri:function(s){if(typeof location==="object"){var q=window.location.pathname.slice(1);b.mapBySlug(s,q)}else{var r="This method is available client side only (JS on browser)";h(s,r)}},listRecommendedProducts:function(t,s){if(l(s)){var q="apx-graphs.e-com.plus";var r="/products/"+s+"/recommended.json";e(t,r,q)}},listRelatedProducts:function(t,s){if(l(s)){var q="apx-graphs.e-com.plus";var r="/products/"+s+"/related.json";e(t,r,q)}},http:e}}());if(a){module.exports=b}else{window.EcomIo=b}}());