(function(){var g=false;if(typeof module!=="undefined"&&module.exports){g=true}var a="api.e-com.plus";var d="ioapi.ecvol.com";var f="e-com.plus";var b="io.ecvol.com";var j="apx-search.e-com.plus";var e="apx-graphs.e-com.plus";var c="apx-mods.e-com.plus";var h="iostorefront.ecvol.com";var i=(function(){var v,q,w,u;if(g&&typeof XMLHttpRequest==="undefined"&&typeof XDomainRequest==="undefined"){w=require("https")}var n=function(y){return"E-Com Plus SDK "+y+":"};var p=function(B,z,A){if(typeof B==="function"){var y=new Error(z);if(A===undefined){B(y,null)}else{B(y,A)}}u.log(n("WARNING")+"\n"+z)};var m=function(E,D,z,y,C){var B;if(typeof E!=="function"){B="You need to specify a callback function to receive the request response";p(null,B);return}var A;if(!z){z=a;A="/v1"}else{switch(z){case d:A="/"+v+"/v1";break;case a:A="/v1";break;default:A="/api/v1"}}A+=D;if(typeof C!=="number"){C=0}l(C,z,A,y,E,D)};var l=function(G,J,L,D,H,I){var y;if(!D){y="GET"}else{y="POST"}var A={};switch(J){case a:case j:case e:A["X-Store-ID"]=v;A["Content-Type"]="application/json";break}var C=function(){if(I){switch(J){case d:J=a;m(H,I,J,D,G);return;case b:J=f;m(H,I,J,D,G);return;case a:J=d;m(H,I,J,D,G);return;case f:J=b;m(H,I,J,D,G);return}}setTimeout(function(){l(G,J,L,D,H)},500)};if(w){var K={hostname:J,path:L,method:y,headers:A};var E=w.request(K,function(M){if(M.statusCode===503&&G<3){C();M.resume();return}var N="";M.setEncoding("utf8");M.on("data",function(O){N+=O});M.on("end",function(){o(M.statusCode,N,H)})});E.on("error",function(M){u.error(M);H(M,null)});if(D){E.write(JSON.stringify(D))}E.end()}else{var F;if(window.XDomainRequest){F=new XDomainRequest();F.ontimeout=F.onerror=function(){C()};F.onload=function(){o(200,this.responseText,H)}}else{F=new XMLHttpRequest();F.onreadystatechange=function(){if(this.readyState===4){if(this.status===503&&G<3){C()}else{o(this.status,this.responseText,H)}}}}var z="https://"+J+L;F.open(y,z,true);for(var B in A){if(A.hasOwnProperty(B)){F.setRequestHeader(B,A[B])}}if(D){F.send(JSON.stringify(D))}else{F.send()}}G++};var o=function(z,B,D){var y;try{y=JSON.parse(B)}catch(A){u.error(A);D(A,null);return}if(z===200){D(null,y)}else{var C;if(y.hasOwnProperty("message")){C=y.message}else{C="Unknown error, see response objet to more info"}p(D,C,y)}};var t=function(A,z){var y;if(typeof z==="string"){if(z.match(/^[a-f0-9]{24}$/)){return true}else{y="ID must be a valid 24 hexadecimal digits string, lowercase only"}}else{y="ID is required and must be a string"}p(A,y);return false};var x=function(B,z,A){if(t(B,A)){var y=d;m(B,"/"+z+"/"+A+".json",y)}};var s=function(E,A,D,y,C,z){if(typeof A==="string"){m(function(H,F){if(!H){var G=F.result;if(Array.isArray(G)&&typeof G[0]==="object"&&G[0]!==null){z(E,G[0]._id)}else{var I="Any "+y+" found with this "+D;p(E,I,F)}}else{E(H,F)}},C)}else{var B="The"+D+" is required and must be a string";p(E,B)}};var r=function(F,y,B,A,C,D,z){var E=k(B,A,C,D,z);var H="/"+y+".json";var G;if(E===""){G=d}else{H+=E}m(F,H,G)};var k=function(D,C,F,G,A){var B={};var H="";if(typeof A!=="string"){if(typeof D==="number"&&D>0){B.offset=D}if(typeof C==="number"&&C>0){B.limit=C}if(typeof F==="number"){switch(F){case 1:B.sort="name";break;case 2:B.sort="-name";break}}if(Array.isArray(G)){var y="";for(var E=0;E<G.length;E++){if(typeof G[E]==="string"){if(y!==""){y+="%2C"}y+=G[E]}}if(y!==""){B.fields=y}}for(var z in B){if(B.hasOwnProperty(z)){if(H!==""){H+="&"}H+=z+"="+B[z]}}}else{H=A}if(H!==""){H="?"+H}return H};return{init:function(E,B,A,y){if(typeof y==="object"&&y.hasOwnProperty("log")&&y.hasOwnProperty("error")){u=y}else{u=console}if(B&&A){v=B;q=A;if(typeof E==="function"){var C={id:null,channel_id:null,store_id:v,store_object_id:q,default_lang:null};E(null,C)}}else{if(typeof location==="object"){var G=b;var F="/domains/"+window.location.hostname+".json";var D=function(I,H){if(!I){v=H.store_id;q=H.store_object_id}if(typeof E==="function"){E(I,H)}};m(D,F,G)}else{var z="It is necessary to specify the store ID as an init argument";p(E,z)}}},storeId:function(){return v},storeObjectId:function(){return q},getStore:function(z,y){if(y===undefined&&q){y=q}x(z,"stores",y)},getProduct:function(z,y){x(z,"products",y)},getProductBySku:function(A,z){var y="/products.json?sku="+z;s(A,z,"SKU","product",y,i.getProduct)},getOrder:function(z,y){x(z,"orders",y)},getCart:function(z,y){x(z,"carts",y)},getCustomer:function(z,y){x(z,"customers",y)},getApplication:function(z,y){x(z,"applications",y)},getBrand:function(z,y){x(z,"brands",y)},findBrandBySlug:function(A,y){var z="/brands.json?limit=1&slug="+y;m(A,z)},listBrands:function(D,C,z,A,y,B){r(D,"brands",C,z,A,y,B)},getCategory:function(z,y){x(z,"categories",y)},findCategoryBySlug:function(A,y){var z="/categories.json?limit=1&slug="+y;m(A,z)},listCategories:function(D,C,z,A,y,B){r(D,"categories",C,z,A,y,B)},getCollection:function(z,y){x(z,"collections",y)},findCollectionBySlug:function(A,y){var z="/collections.json?limit=1&slug="+y;m(A,z)},listCollections:function(D,C,z,A,y,B){r(D,"collections",C,z,A,y,B)},getById:x,searchProducts:function(K,B,I,O,D,A,z,N,F,C,y){var M=j;var L="/items.json";var G;if(typeof y==="object"&&y!==null){G=y}else{if(typeof D==="number"){switch(D){case 1:D={sales:{order:"desc"}};break;case 2:D={price:{order:"asc"}};break;case 3:D={price:{order:"desc"}};break;default:D={views:{order:"desc"}}}}else{if(!D){D={views:{order:"desc"}}}}G={query:{bool:{filter:[{term:{visible:true}}]}},sort:[{available:{order:"desc"}},"_score",{ad_relevance:{order:"desc"}},D],aggs:{brands:{terms:{field:"brands.name"}},categories:{terms:{field:"categories.name"}},specs:{nested:{path:"specs"},aggs:{grid:{terms:{field:"specs.grid",size:12},aggs:{text:{terms:{field:"specs.text"}}}}}},min_price:{min:{field:"price"}},max_price:{max:{field:"price"}},avg_price:{avg:{field:"price"}}}};if(typeof B==="string"){G.query.bool.must={multi_match:{query:B,fields:["name","keywords"]}}}if(typeof I==="number"&&I>0){G.from=I}if(typeof O==="number"&&O>0){G.size=O}else{G.size=24}if(typeof A==="object"&&A!==null&&Object.keys(A).length>0){var H={nested:{path:"specs",query:{bool:{filter:[]}}}};for(var J in A){if(Array.isArray(A[J])&&A[J].length>0){H.nested.query.bool.filter.push({bool:{filter:[{term:{"specs.grid":J}},{terms:{"specs.text":A[J]}}]}});G.query.bool.filter.push(H)}}}if(Array.isArray(z)&&z.length>0){G.query.bool.filter.push({terms:{_id:z}})}if(Array.isArray(N)&&N.length>0){G.query.bool.filter.push({terms:{"brands.name":N}})}if(Array.isArray(F)&&F.length>0){G.query.bool.filter.push({terms:{"categories.name":F}})}if(typeof C==="object"&&C!==null&&Object.keys(C).length>0){var E={range:{price:{}}};if(typeof C.min==="number"&&!isNaN(C.min)){E.range.price.gte=C.min}if(typeof C.max==="number"&&!isNaN(C.max)){E.range.price.lte=C.max}G.query.bool.filter.push(E)}}m(K,L,M,G)},mapBySlug:function(C,z){var A=h;var B="/"+v+"@"+z.replace("/","$")+".json";var y=function(E,D){if(!E){var G=D.GET;if(G){G=G.split("@");D={resource:G[0],_id:G[1]};C(null,D)}else{D={status:404,error_code:-44,message:"Page not found, invalid slug or store ID"};var F=D.message;p(C,F,D)}}else{C(E,D)}};m(y,B,A)},mapByWindowUri:function(A){if(typeof location==="object"){var y=window.location.pathname.slice(1);i.mapBySlug(A,y)}else{var z="This method is available client side only (JS on browser)";p(A,z)}},listRecommendedProducts:function(B,A){if(t(B,A)){var y=e;var z="/products/"+A+"/recommended.json";m(B,z,y)}},listRelatedProducts:function(B,A){if(t(B,A)){var y=e;var z="/products/"+A+"/related.json";m(B,z,y)}},calculateShipping:function(A,y){var z="/calculate_shipping.json";m(A,z,c,y)},listPayments:function(A,y){var z="/list_payments.json";m(A,z,c,y)},createTransaction:function(A,y){var z="/create_transaction.json";m(A,z,c,y)},http:m}}());if(g){module.exports=i}else{window.EcomIo=i}}());