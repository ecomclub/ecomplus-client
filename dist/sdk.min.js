(function(){var h=false;if(typeof module!=="undefined"&&module.exports){h=true}var b="api.e-com.plus";var e="ioapi.ecvol.com";var g="e-com.plus";var c="io.ecvol.com";var k="apx-search.e-com.plus";var f="apx-graphs.e-com.plus";var d="apx-mods.e-com.plus";var i="iostorefront.ecvol.com";var a="checkout.e-com.plus";var j=(function(){var w,r,x,v;if(h&&typeof XMLHttpRequest==="undefined"&&typeof XDomainRequest==="undefined"){x=require("https")}var o=function(z){return"E-Com Plus SDK "+z+":"};var q=function(C,A,B){if(typeof C==="function"){var z=new Error(A);if(B===undefined){C(z,null)}else{C(z,B)}}v.log(o("WARNING")+"\n"+A)};var n=function(F,E,A,z,D){var C;if(typeof F!=="function"){C="You need to specify a callback function to receive the request response";q(null,C);return}var B;if(!A){A=b;B="/v1"}else{switch(A){case e:B="/"+w+"/v1";break;case b:B="/v1";break;default:B="/api/v1"}}B+=E;if(typeof D!=="number"){D=0}m(D,A,B,z,F,E)};var m=function(H,K,M,E,I,J){var z;if(!E){z="GET"}else{z="POST"}var B={};switch(K){case b:case k:case f:B["X-Store-ID"]=w;B["Content-Type"]="application/json";break}var D=function(){if(J){switch(K){case e:K=b;n(I,J,K,E,H);return;case c:K=g;n(I,J,K,E,H);return;case b:K=e;n(I,J,K,E,H);return;case g:K=c;n(I,J,K,E,H);return}}setTimeout(function(){m(H,K,M,E,I)},500)};if(x){var L={hostname:K,path:M,method:z,headers:B};var F=x.request(L,function(N){if(N.statusCode===503&&H<3){D();N.resume();return}var O="";N.setEncoding("utf8");N.on("data",function(P){O+=P});N.on("end",function(){p(N.statusCode,O,I)})});F.on("error",function(N){v.error(N);I(N,null)});if(E){F.write(JSON.stringify(E))}F.end()}else{var G;if(window.XDomainRequest){G=new XDomainRequest();G.ontimeout=G.onerror=function(){D()};G.onload=function(){p(200,this.responseText,I)}}else{G=new XMLHttpRequest();G.onreadystatechange=function(){if(this.readyState===4){if(this.status===503&&H<3){D()}else{p(this.status,this.responseText,I)}}}}var A="https://"+K+M;G.open(z,A,true);for(var C in B){if(B.hasOwnProperty(C)){G.setRequestHeader(C,B[C])}}if(E){G.send(JSON.stringify(E))}else{G.send()}}H++};var p=function(A,C,E){var z;try{z=JSON.parse(C)}catch(B){v.error(B);E(B,null);return}if(A===200){E(null,z)}else{var D;if(z.hasOwnProperty("message")){D=z.message}else{D="Unknown error, see response objet to more info"}q(E,D,z)}};var u=function(B,A){var z;if(typeof A==="string"){if(A.match(/^[a-f0-9]{24}$/)){return true}else{z="ID must be a valid 24 hexadecimal digits string, lowercase only"}}else{z="ID is required and must be a string"}q(B,z);return false};var y=function(C,A,B){if(u(C,B)){var z=e;n(C,"/"+A+"/"+B+".json",z)}};var t=function(F,B,E,z,D,A){if(typeof B==="string"){n(function(I,G){if(!I){var H=G.result;if(Array.isArray(H)&&typeof H[0]==="object"&&H[0]!==null){A(F,H[0]._id)}else{var J="Any "+z+" found with this "+E;q(F,J,G)}}else{F(I,G)}},D)}else{var C="The"+E+" is required and must be a string";q(F,C)}};var s=function(G,z,C,B,D,E,A){var F=l(C,B,D,E,A);var I="/"+z+".json";var H;if(F===""){H=e}else{I+=F}n(G,I,H)};var l=function(E,D,G,H,B){var C={};var I="";if(typeof B!=="string"){if(typeof E==="number"&&E>0){C.offset=E}if(typeof D==="number"&&D>0){C.limit=D}if(typeof G==="number"){switch(G){case 1:C.sort="name";break;case 2:C.sort="-name";break}}if(Array.isArray(H)){var z="";for(var F=0;F<H.length;F++){if(typeof H[F]==="string"){if(z!==""){z+="%2C"}z+=H[F]}}if(z!==""){C.fields=z}}for(var A in C){if(C.hasOwnProperty(A)){if(I!==""){I+="&"}I+=A+"="+C[A]}}}else{I=B}if(I!==""){I="?"+I}return I};return{init:function(F,C,B,z){if(typeof z==="object"&&z.hasOwnProperty("log")&&z.hasOwnProperty("error")){v=z}else{v=console}if(C&&B){w=C;r=B;if(typeof F==="function"){var D={id:null,channel_id:null,store_id:w,store_object_id:r,default_lang:null};F(null,D)}}else{if(typeof location==="object"){var H=c;var G="/domains/"+window.location.hostname+".json";var E=function(J,I){if(!J){w=I.store_id;r=I.store_object_id}if(typeof F==="function"){F(J,I)}};n(E,G,H)}else{var A="It is necessary to specify the store ID as an init argument";q(F,A)}}},storeId:function(){return w},storeObjectId:function(){return r},getStore:function(A,z){if(z===undefined&&r){z=r}y(A,"stores",z)},getProduct:function(A,z){y(A,"products",z)},getProductBySku:function(B,A){var z="/products.json?sku="+A;t(B,A,"SKU","product",z,j.getProduct)},getOrder:function(A,z){y(A,"orders",z)},getCart:function(A,z){y(A,"carts",z)},getCustomer:function(A,z){y(A,"customers",z)},getApplication:function(A,z){y(A,"applications",z)},getBrand:function(A,z){y(A,"brands",z)},findBrandBySlug:function(B,z){var A="/brands.json?limit=1&slug="+z;n(B,A)},listBrands:function(E,D,A,B,z,C){s(E,"brands",D,A,B,z,C)},getCategory:function(A,z){y(A,"categories",z)},findCategoryBySlug:function(B,z){var A="/categories.json?limit=1&slug="+z;n(B,A)},listCategories:function(E,D,A,B,z,C){s(E,"categories",D,A,B,z,C)},getCollection:function(A,z){y(A,"collections",z)},findCollectionBySlug:function(B,z){var A="/collections.json?limit=1&slug="+z;n(B,A)},listCollections:function(E,D,A,B,z,C){s(E,"collections",D,A,B,z,C)},getById:y,searchProducts:function(L,D,J,P,F,C,A,O,H,E,z){var N=k;var M="/items.json";var I;if(typeof z==="object"&&z!==null){I=z}else{var B=[{available:{order:"desc"}},{ad_relevance:{order:"desc"}},"_score"];switch(F){case 1:B.splice(2,0,{sales:{order:"desc"}});break;case 2:B.splice(1,0,{price:{order:"asc"}});break;case 3:B.splice(1,0,{price:{order:"desc"}});break;default:B.push({views:{order:"desc"}})}I={query:{bool:{filter:[{term:{visible:true}}]}},sort:B,aggs:{brands:{terms:{field:"brands.name"}},categories:{terms:{field:"categories.name"}},specs:{nested:{path:"specs"},aggs:{grid:{terms:{field:"specs.grid",size:12},aggs:{text:{terms:{field:"specs.text"}}}}}},min_price:{min:{field:"price"}},max_price:{max:{field:"price"}},avg_price:{avg:{field:"price"}}}};if(typeof D==="string"){I.query.bool.must={multi_match:{query:D,fields:["name","keywords"]}}}if(typeof J==="number"&&J>0){I.from=J}if(typeof P==="number"&&P>0){I.size=P}else{I.size=24}if(typeof C==="object"&&C!==null&&Object.keys(C).length>0){for(var K in C){if(Array.isArray(C[K])&&C[K].length>0){I.query.bool.filter.push({nested:{path:"specs",query:{bool:{filter:[{term:{"specs.grid":K}},{terms:{"specs.text":C[K]}}]}}}})}}}if(Array.isArray(A)&&A.length>0){I.query.bool.filter.push({terms:{_id:A}})}if(Array.isArray(O)&&O.length>0){I.query.bool.filter.push({terms:{"brands.name":O}})}if(Array.isArray(H)&&H.length>0){I.query.bool.filter.push({terms:{"categories.name":H}})}if(typeof E==="object"&&E!==null&&Object.keys(E).length>0){var G={range:{price:{}}};if(typeof E.min==="number"&&!isNaN(E.min)){G.range.price.gte=E.min}if(typeof E.max==="number"&&!isNaN(E.max)){G.range.price.lte=E.max}I.query.bool.filter.push(G)}}n(L,M,N,I)},mapBySlug:function(D,A){var B=i;var C="/"+w+"@"+A.replace("/","$")+".json";var z=function(F,E){if(!F){var H=E.GET;if(H){H=H.split("@");E={resource:H[0],_id:H[1]};D(null,E)}else{E={status:404,error_code:-44,message:"Page not found, invalid slug or store ID"};var G=E.message;q(D,G,E)}}else{D(F,E)}};n(z,C,B)},mapByWindowUri:function(B){if(typeof location==="object"){var z=window.location.pathname.slice(1);j.mapBySlug(B,z)}else{var A="This method is available client side only (JS on browser)";q(B,A)}},listRecommendedProducts:function(C,B){if(u(C,B)){var z=f;var A="/products/"+B+"/recommended.json";n(C,A,z)}},listRelatedProducts:function(C,B){if(u(C,B)){var z=f;var A="/products/"+B+"/related.json";n(C,A,z)}},calculateShipping:function(B,z){var A="/calculate_shipping.json";n(B,A,d,z)},listPayments:function(B,z){var A="/list_payments.json";n(B,A,d,z)},createTransaction:function(B,z){var A="/create_transaction.json";n(B,A,d,z)},checkout:function(B,z){var A="/do.json";n(B,A,a,z)},http:n}}());if(h){module.exports=j}else{window.EcomIo=j}}());